
<div class="main-chat-container hide-chatbot d-flex align-items-center justify-content-center overflow-hidden">
    <div class="container chat-container-wrapper overflow-hidden py-4 px-4" style="border-radius: 30px;">
        <div class="chatbot-header">
            <div style="display: flex; align-items: center; gap: 12px;">
                <i class="fa fa-cubes fa-2x text-dark mr-2" ></i>
                <span class="text-dark mb-0" style="font-weight: 800; font-size: 20px;">Lawa.ai</span>
            </div>
            <button class="closechatbot">
                <svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M5.29289 5.29289C5.68342 4.90237 6.31658 4.90237 6.70711 5.29289L12 10.5858L17.2929 5.29289C17.6834 4.90237 18.3166 4.90237 18.7071 5.29289C19.0976 5.68342 19.0976 6.31658 18.7071 6.70711L13.4142 12L18.7071 17.2929C19.0976 17.6834 19.0976 18.3166 18.7071 18.7071C18.3166 19.0976 17.6834 19.0976 17.2929 18.7071L12 13.4142L6.70711 18.7071C6.31658 19.0976 5.68342 19.0976 5.29289 18.7071C4.90237 18.3166 4.90237 17.6834 5.29289 17.2929L10.5858 12L5.29289 6.70711C4.90237 6.31658 4.90237 5.68342 5.29289 5.29289Z" fill="#0F1729"></path> </g></svg>
            </button>
        </div>
        <div class="chat-container w-100 hide-scrolllbar" style="flex-grow: 1; padding: 20px 0px; display: flex; flex-direction: column; gap: 10px; background-color: white; overflow-y: scroll; text-wrap: pretty;">
    
            <div class="start-block" style="width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <i class="fa fa-cubes fa-5x text-dark" ></i>
                <span class="text-center text-dark" style="max-width: 70%; margin-top: 10px; font-size: 20px; font-weight: 500;">
                    Start asking your questions and the agent will answer them.
                </span>
                <div class="w-100 d-flex flex-column align-items-center mt-4" style="max-width: 800px;">
                    <h6 class="mb-3">
                        <i class="fa fa-list mr-2" ></i>
                        Example questions
                    </h6>
                    <div class="d-flex flex-wrap align-items-center justify-content-center" >
                        <span class="question-item border bg-secondary px-3 py-2 mr-2 mb-2 rounded-xl" style="cursor: pointer;">List out the tours to India?</span>
                        <span class="question-item border bg-secondary px-3 py-2 mr-2 mb-2 rounded-xl" style="cursor: pointer;">Which tour include visit to Taj Mahal?</span>
                        <span class="question-item border bg-secondary px-3 py-2 mr-2 mb-2 rounded-xl" style="cursor: pointer;">How much is the cost of a tour to France?</span>
                        <span class="question-item border bg-secondary px-3 py-2 mr-2 mb-2 rounded-xl" style="cursor: pointer;">Tell me popular places to visit in Osaka?</span>
                        <span class="question-item border bg-secondary px-3 py-2 mr-2 mb-2 rounded-xl" style="cursor: pointer;">How can I apply for Dubai visa?</span>
                        <span class="question-item border bg-secondary px-3 py-2 mr-2 mb-2 rounded-xl" style="cursor: pointer;">Which documents are required to get American visa?</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="input-options-container border rounded-pill" style="width: 100%; display: flex; justify-content: space-between; align-items: center; gap: 5px; padding: 12px; border-top: 1px solid rgb(218, 218, 218);">
            <div class="hide-scrolllbar" style="flex-grow: 1; display: flex; align-items: center; gap: 16px; overflow-y: scroll; overflow: visible;">
                <button id="micStartButton" class="d-flex align-items-center justify-content-center rounded-circle border-0 p-0 m-0" style="width: 50px; height: 50px; outline: none;">
                    <i class="fas fa-microphone fa-lg"></i>
                </button>
                <div id="question-box" class="d-inline-block" role="textbox" contenteditable="true" data-placeholder="Write your question here... " style="width: 100%; max-height: 100px; outline: none; font-weight: 500; font-size: 16px;">
                </div>
            </div>
            <button class="sendbtn" style="display: block; padding: 8px; aspect-ratio: 1; display: flex; align-items: center; justify-content: center; border-radius: 30px; border: none; color: white;">
                <svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" stroke="#000000"  xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M11.5003 12H5.41872M5.24634 12.7972L4.24158 15.7986C3.69128 17.4424 3.41613 18.2643 3.61359 18.7704C3.78506 19.21 4.15335 19.5432 4.6078 19.6701C5.13111 19.8161 5.92151 19.4604 7.50231 18.7491L17.6367 14.1886C19.1797 13.4942 19.9512 13.1471 20.1896 12.6648C20.3968 12.2458 20.3968 11.7541 20.1896 11.3351C19.9512 10.8529 19.1797 10.5057 17.6367 9.81135L7.48483 5.24303C5.90879 4.53382 5.12078 4.17921 4.59799 4.32468C4.14397 4.45101 3.77572 4.78336 3.60365 5.22209C3.40551 5.72728 3.67772 6.54741 4.22215 8.18767L5.24829 11.2793C5.34179 11.561 5.38855 11.7019 5.407 11.8459C5.42338 11.9738 5.42321 12.1032 5.40651 12.231C5.38768 12.375 5.34057 12.5157 5.24634 12.7972Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
            </button>
        </div>
    </div>
</div>

<button class="startchatbtn pulse btn btn-warning border-0 rounded-circle d-flex align-items-center justify-content-center p-2" style="width: 60px; height:60px; position: fixed; bottom: 30px; right: 30px; z-index: 10; cursor: pointer;" >
    <i class="fa fa-cubes fa-2x text-dark" ></i>
</button>


    
<script>
    const startButton = document.getElementById('micStartButton');

    let recognition;
    let isRecording = false;

    if ('webkitSpeechRecognition' in window) {
        recognition = new webkitSpeechRecognition();
        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.lang = 'en-US';

        recognition.onstart = function() {
            isRecording = true;
        };

        recognition.onresult = function(event) {
            let interimTranscript = '';
            let finalTranscript = '';

            for (let i = event.resultIndex; i < event.results.length; ++i) {
                if (event.results[i].isFinal) {
                    finalTranscript += event.results[i][0].transcript;
                    // sendToBackend(finalTranscript);
                    $("#question-box").text(finalTranscript);
                } else {
                    interimTranscript += event.results[i][0].transcript;
                    $("#question-box").text(interimTranscript);
                }
            }
        };

        recognition.onerror = function(event) {
            console.error('Speech recognition error:', event.error);
            alert('Error occurred. Try again.');
        };

        recognition.onend = function() {
            if (isRecording) {
                recognition.start();
            } else {
                startButton.classList.remove("pulse");
            }
        };
    } else {
        console.log('Speech recognition not supported');
        statusDiv.textContent = 'Speech recognition not supported in this browser.';
    }

    startButton.addEventListener('click', function() {
        if (isRecording) {
            recognition.stop();
            isRecording = false;
            
        } else {
            recognition.start();
            startButton.classList.add("pulse");
            $("#question-box span").attr("data-placeholder", "Listening...")
        }
    });

    function sendToBackend(text) {
        fetch('/process_question/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({question: text})
        })
        .then(response => response.json())
        .then(data => {
            $("#question-box").text(data.answer);
        })
        .catch(error => {
            console.error('Error:', error);
            $("#question-box").text('Error processing question.');;
        });
    }

</script>